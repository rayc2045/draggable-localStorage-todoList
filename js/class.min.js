"use strict";class TodoApp{constructor(){this.todolist=JSON.parse(localStorage.getItem("todolist"))||[{task:'可使用任務左側 ": :" 符號拖曳項目',completed:!1},{task:'可使用任務右側 "✕" 符號刪除項目',completed:!1},{task:"點擊任務後可自由進行編輯",completed:!1},{task:"自動儲存機制將保留任何更動",completed:!1},{task:"開始嘗試新增您的第一項任務！",completed:!1}],this.maxTaskNumber=10,this.accomplishSound=new Audio("https://github.com/raychang2017/f2e-portfolio/blob/master/06%20-%20%E5%8F%AF%E6%8B%96%E6%8B%89%E4%BB%BB%E5%8B%99%E7%9A%84%20LocalStorage%20%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%B8%85%E5%96%AE/audio/BOTW_Fanfare_SmallItem.wav?raw=true"),this.deleteSound=new Audio("https://github.com/raychang2017/f2e-portfolio/blob/master/06%20-%20%E5%8F%AF%E6%8B%96%E6%8B%89%E4%BB%BB%E5%8B%99%E7%9A%84%20LocalStorage%20%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%B8%85%E5%96%AE/audio/BotW_Interact_sound.mp3?raw=true"),this.dragSound=new Audio("https://github.com/raychang2017/f2e-portfolio/blob/master/06%20-%20%E5%8F%AF%E6%8B%96%E6%8B%89%E4%BB%BB%E5%8B%99%E7%9A%84%20LocalStorage%20%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%B8%85%E5%96%AE/audio/drag.mp3?raw=true"),this.dropSound=new Audio("https://github.com/raychang2017/f2e-portfolio/blob/master/06%20-%20%E5%8F%AF%E6%8B%96%E6%8B%89%E4%BB%BB%E5%8B%99%E7%9A%84%20LocalStorage%20%E5%BE%85%E8%BE%A6%E4%BA%8B%E9%A0%85%E6%B8%85%E5%96%AE/audio/drop.mp3?raw=true"),this.events()}events(){this.updateTasks(),this.addTask(),this.toggleComplete(),this.editTask(),this.deleteTask(),this.sortablejs(),this.rearrangeTodolist()}debug(){const self=this;$("#todolist").on("click",(function(){console.log(self.todolist)})),$(".new-item input").keydown((function(e){13===e.which&&console.log('"'+$(this).val()+'" is added.')})),$(".items").on("click",".delete",(function(){console.log('"'+$(this).closest(".item").find(".content").text()+'" is deleted.')})),$(".items").change((function(){console.log(".items changed")}))}demo_f2eLearning(){localStorage.setItem("todolist",JSON.stringify([{task:"HTML + CSS 網頁基礎",completed:!1},{task:"Flexbox + CSS Grid 響應式佈局",completed:!1},{task:"JavaScript + DOM 操作",completed:!1},{task:"Git/Github 版本控制",completed:!1},{task:"搭建網站/Github page",completed:!1},{task:"Node.js + NPM 套件管理",completed:!1},{task:"React.js/Vue.js 前端框架",completed:!1},{task:"HTTP + AJAX/JSON API 服務整合",completed:!1},{task:"作品集 + 一頁式履歷",completed:!1},{task:"尋找、取得 offer",completed:!1}]))}updateTasks(){$(".items").empty();for(let i=0;i<this.todolist.length;i++)$(".items").append(`\n        <div class="item" id="item_${i}">\n          <div class="handle">: :</div>\n          <input type="checkbox"${this.todolist[i].completed?" checked":""}>\n          <div class="check">✓</div>\n          <div class="content">${this.todolist[i].task}</div>\n          <div class="delete">✕</div>\n        </div>`);this.changePlaceholder(this.maxTaskNumber)}addTask(){const self=this;$(".new-item input").keydown((function(e){if($(".item").length>self.maxTaskNumber-1)return e.preventDefault();if(13===e.which){const input=$(this).val().trim();if(!input)return;self.todolist.push({task:input,completed:!1}),localStorage.setItem("todolist",JSON.stringify(self.todolist)),self.updateTasks(),$(this).val(""),self.soundPlay(self.dropSound)}}))}toggleComplete(){const self=this;$(".items").on("click","input",(function(){const index=$(this).closest(".item").attr("id").replace(/item_/g,"");self.todolist[index].completed=!self.todolist[index].completed,localStorage.setItem("todolist",JSON.stringify(self.todolist)),$(".content").blur(),$(this).is(":checked")&&self.soundPlay(self.accomplishSound)}))}editTask(){const self=this;$(".items").on("mousedown",".content",(function(){$(this).prop("contenteditable",!0)})),$(".items").on("keydown",".content",(function(e){13===e.which&&$(this).blur()})),$(".items").on("blur",".content",(function(){const index=$(this).closest(".item").attr("id").replace(/item_/g,"");self.todolist[index].task=$(this).text().trim(),localStorage.setItem("todolist",JSON.stringify(self.todolist)),$(this).prop("contenteditable",!1),self.updateTasks()}))}deleteTask(){const self=this;$(".items").on("click",".delete",(function(){const item=$(this).closest(".item"),index=item.attr("id").replace(/item_/g,"");self.todolist.splice(index,1),localStorage.setItem("todolist",JSON.stringify(self.todolist)),item.remove(),self.todolist.length||localStorage.removeItem("todolist"),self.updateTasks(),self.soundPlay(self.deleteSound)}))}soundPlay(audio){audio.currentTime=0,audio.play()}changePlaceholder(maxTaskNumber){$(".item").length>maxTaskNumber-1?$(".new-item input").attr("placeholder","Try to make tasks less..."):$(".new-item input").attr("placeholder","What needs to be done?")}sortablejs(){Sortable.create(sortable,{animation:100,handle:".handle",draggable:".item",ghostClass:"dragging"}),$(".items").on("mousedown",".handle",()=>{this.soundPlay(this.dragSound)})}rearrangeTodolist(){const self=this;$(".items").change((function(){for(let i=0;i<self.todolist.length;i++)self.todolist[i].task=$(".item").eq(i).find(".content").text(),self.todolist[i].completed=$(".item").eq(i).find("input").prop("checked"),localStorage.setItem("todolist",JSON.stringify(self.todolist)),$(".item").eq(i).attr("id",`item_${i}`),self.soundPlay(self.dropSound)}))}}let todoApp=new TodoApp;